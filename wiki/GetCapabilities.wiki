#summary GetCapabilities Requests, Responses, and Conventions
#labels SOS

<wiki:toc max_depth="3" />

=Introduction=

GetCapabilities provides summary information about the service and about the platforms for which it provides data.

  * Go over guidelines, rules, and minimum requirements needed for ows:ServiceIdentification, ows:ServiceProvider, ows:OperationsMetadata, and sos:Contents
  * patterns and guides for title, keywords, and maybe abstract

=Interface Definition Document (IDD)=

Issuing the request: bla bla bla

Example request: http://sdf.ndbc.noaa.gov/sos/server.php?request=GetCapabilities&service=SOS

*FROM OOSTETHYS GET DOCUMENT:*

The parameters rules for the !GetCapabilities operation are taken from table 3 and table 5 of [http://portal.opengeospatial.org/files/?artifact_id=20040 OGC 06-121r3]

Example: http://host[:port]/path?request=GetCapabilities&service=SOS&version=1.0.0

|| *Parameter Name* || *Definition* || *Data type and Values* || *Multiplicity and Use of the Parameter* ||
|| request || Operation name || !GetCapabilities || One (mandatory)||
|| service || Service type identifier || SOS || One (mandatory)||
|| !AcceptFormats || Comma-separated prioritized sequence of zero or more response formats desired by client, with preferred formats listed first || text/xml || One (mandatory). When omitted or not supported by server, return service metadata document using MIME type "text/xml" .||
|| !AcceptVersions || Prioritized sequence of one more specification versions accepted by client, with preferred versions listed first || 1.0.0 has format X.Y.Z || Zero or more (optional). ||

  * *Recommendation:* Request should implement *'Sections'* parameter, for easier and lighter metadata parsing, eg: http://host[:port]/path?request=GetCapabilities&service=SOS&version=1.0.0&sections=OperationsMetadata
  * https://wiki.52north.org/bin/view/Sensornet/GetCapabilities

=Response=

The GetCapabilities response is an XML document with four sections:
  * [#ServiceIdentification_Section ServiceIdentification] provides a brief summary description of the service and the type of data it offers.
  * [#ServiceProvider_Section ServiceProvider] provides information about the operator of the service.
  * [#OperationsMetadata_Section OperationsMetadata] provides detail URL endpoints and allowed parameters for each operation.
  * [#Contents_Section Contents] provides a detailed listing of the observations offered by the SOS.

==!ServiceIdentification Section==

{{{
<ows:ServiceIdentification>
  <ows:Title>NANOOS Sensor Observation Service (SOS)</ows:Title>
  <ows:Abstract>Sensor Observation Service (SOS) Server for NANOOS, blah-blah.</ows:Abstract>
  <ows:Keywords>
    <ows:Keyword>NANOOS</ows:Keyword>
    <ows:Keyword>Air Temperature</ows:Keyword>
    <ows:Keyword>Chlorophyll</ows:Keyword>
    <ows:Keyword>Salinity</ows:Keyword>
    <ows:Keyword>Water Temperature</ows:Keyword>
    <ows:Keyword>Pacific Northwest</ows:Keyword>
    <ows:Keyword>Oregon</ows:Keyword>
  </ows:Keywords>
  <ows:ServiceType codeSpace="http://opengeospatial.net">OGC:SOS</ows:ServiceType>
  <ows:ServiceTypeVersion>1.0.0</ows:ServiceTypeVersion>
  <ows:Fees>NONE</ows:Fees> 
  <ows:AccessConstraints>NONE</ows:AccessConstraints>
</ows:ServiceIdentification>
}}}

==!ServiceProvider Section==

{{{
<ows:ServiceProvider>
  <ows:ProviderName>NANOOS - Northwest Association of Networked Ocean Observing Systems</ows:ProviderName>
  <ows:ProviderSite xlink:href="http://www.nanoos.org"/>
  <ows:ServiceContact>
    <ows:IndividualName>Emilio Mayorga</ows:IndividualName>
    <ows:ContactInfo>
      <ows:Phone>
        <ows:Voice>206-543-6431</ows:Voice>
      </ows:Phone>
      <ows:Address>
        <ows:DeliveryPoint></ows:DeliveryPoint>
        <ows:City>Seattle</ows:City>
        <ows:AdministrativeArea>WA</ows:AdministrativeArea>
        <ows:PostalCode>98195</ows:PostalCode>
        <ows:Country>USA</ows:Country>
        <ows:ElectronicMailAddress>mayorga@apl.washington.edu</ows:ElectronicMailAddress>
      </ows:Address>
    </ows:ContactInfo>
  </ows:ServiceContact>
</ows:ServiceProvider>
}}}

==!OperationsMetadata Section==

  * ows:OperationsMetadata/ows:Operation@[name=GetObservation]
    * What should be listed under ows:Parameter@[name=offering]/ows:AllowedValues ?
      * Each and every asset/platform actually available? But what happens when there's a 'network' request?
      * Full urn's, unqualified (naked) values, or both? My reccommendation: Only full urn's?
      * But in sos:Contents/sos:ObservationOfferingList, sos:ObservationOffering@[gml:id] is specified as the naked unqualified station value, not full urn! eg: gml:id="station-ORCA_Hansville"
      * So, the offering Parameter should be exactly like this. (and where is the "station-" and "network-" prefix convention specified or described?)
    * What should be listed under ows:Parameter@[name=observedProperty]/ows:AllowedValues ? Full urn's, unqualified (naked) values, or both? My reccommendation: Only full urn's
  * ows:OperationsMetadata/ows:Operation@[name=DescribeSensor]
    * What should be listed under ows:Parameter@[name=procedure]/ows:AllowedValues ? Each and every asset/platform actually available? But what happens when there's a 'network' request? Full urn's, unqualified (naked) values, or both? My reccommendation: Only full urn's?
  * Should ows:Parameter@[name=service] and ows:Parameter@[name=version] be repeated in each ows:Operation, or is it ok to list them just once, right under ows:OperationsMetadata ?

==Contents Section==

The Contents section of Capabilities XML is a list of one or more observation offerings; each offering corresponds to a single platform or a network of platforms. The following information is provided for each offering:

===Offering (platform) general description===

====Example response for an offering (from NANOOS)====
{{{
<sos:ObservationOffering gml:id="station-APL_NPB2Carr">
  <gml:description>LSG NPB-2 Profiling Buoy at Carr Inlet. APL-UW Buoy asset (NANOOS: APL_NPB2Carr)</gml:description>
  <gml:name>urn:ioos:station:nanoos:APL_NPB2Carr</gml:name>
  <gml:srsName>urn:ogc:def:crs:epsg::4326</gml:srsName>
  <gml:boundedBy>
    <gml:Envelope srsName="urn:ogc:def:crs:epsg::4326">
      <gml:lowerCorner>47.2800 -122.7300</gml:lowerCorner>
      <gml:upperCorner>47.2800 -122.7300</gml:upperCorner>
    </gml:Envelope>
  </gml:boundedBy>
  <sos:time>
    <gml:TimePeriod> 
        <gml:beginPosition>2012-01-08T05:20:51Z</gml:beginPosition>
        <gml:endPosition indeterminatePosition="now"/>
    </gml:TimePeriod>
  </sos:time>
  <sos:procedure xlink:href="urn:ioos:station:nanoos:APL_NPB2Carr"/>
  <sos:observedProperty xlink:href="http://mmisw.org/ont/cf/parameter/wind_speed"/>
  <sos:observedProperty xlink:href="http://mmisw.org/ont/cf/parameter/wind_speed_of_gust"/>
  <sos:observedProperty xlink:href="http://mmisw.org/ont/cf/parameter/wind_from_direction"/>
  <sos:observedProperty xlink:href="http://mmisw.org/ont/cf/parameter/surface_air_pressure"/>
  <sos:observedProperty xlink:href="http://mmisw.org/ont/cf/parameter/air_temperature"/>
  <sos:observedProperty xlink:href="http://mmisw.org/ont/cf/parameter/sea_water_salinity"/>
  <sos:observedProperty xlink:href="http://mmisw.org/ont/cf/parameter/sea_water_temperature"/>
  <sos:featureOfInterest xlink:href="urn:cgi:Feature:CGI:EarthOcean"/>
  <sos:responseFormat>text/csv</sos:responseFormat>
  <sos:responseFormat>text/plain</sos:responseFormat>
  <sos:responseFormat>application/xml</sos:responseFormat>
  <sos:resultModel>om:Observation</sos:resultModel>
  <sos:responseMode>inline</sos:responseMode>
</sos:ObservationOffering>
}}}

====gml:id====
_Role:_ Brief attribute which is required by the XML schema rules but is not the official platform identifier.<br>
_Content:_ IOOS convention has been to use gml:id values starting with 'station-' for individual platforms and 'network-' for networks of platforms, with additional characters derived from the actual IOOS identifier (see gml:name).<br>
_Example:_ station-21401.<br>
_Note:_ XML rules permit a gml:id to be random string of letters and characters as long as it is unique within the file. Do not rely on the gml:id value remaining constant for a given offering.

====gml:name====
_Role:_ The official IOOS identifier for the platform or network.<br>
_Content:_ A Uniform Resource Name (URN) that obeys the IOOS URN convention described at [Fill in URL].<br>
_Example:_ urn:ioos:station:wmo:21401.<br>
_Note:_ gml:name is now redundant with procedure. There has been discussion of using gml:name for the station name information now found in gml:description.

====gml:description====
_Role:_ The name of the station assigned by the data provider. This is sometimes more descriptive than the IOOS identifier.<br>
_Content:_ A human-readable string at the discretion of the provider.<br>
_Example:_ 250NM Southeast of Iturup Island.<br>
_Note:_ If the Name information is moved to gml:name (see above), this field could be either eliminated or used for additional description of the platform type.

===Spatial Information===

====gml:boundedBy====
_Role:_ The location or bounding box of the platform or network.
Content: A gml:Envelope providing coordinate values and a spatial reference system (SRS) identifier (see srsName). IOOS uses latitude/longitude coordinates in decimal degrees. The coordinates are given as a lower corner (southwest) and an upper corner (northeast). For fixed platforms, both values are the same. For moored buoys with a nominal location and watch radius, the nominal location is provided. For moving sensors, the overall bounding box of the trajectory is provided. For a network of sensors, the overall bounds of the network are provided.<br>
_Example:_
{{{
<gml:boundedBy>
  <gml:Envelope srsName="urn:ogc:def:crs:epsg::4326">
    <gml:lowerCorner>42.617 152.583</gml:lowerCorner>
    <gml:upperCorner>42.617 152.583</gml:upperCorner>
  </gml:Envelope>
</gml:boundedBy>
}}}

====srsName====
_Role:_ States the spatial reference system (a.k.a. coordinate reference system) used by geographic locations.<br>
_Content:_ A URN defined by OGC based on the European Petroleum Survey Group (EPSG) database of coordinate reference systems. IOOS uses decimal latitude/longitude in the World Geodetic System 1984 (WGS84), as identified by the value in the example.<br>
_Example:_ urn:ogc:def:crs:epsg::4326<br>
_Note:_ srsName appears redundantly in two places: inside gml:boundedBy (as an attribute of the gml:Envelope) and as a separate gml:srsName. If may be permitted to eliminate gml:srsName -- some investigation is required.

===Temporal Information===

====time====
_Role:_ States the time period for which data are available from this offering.<br>
_Content:_ a gml:TimePeriod providing a beginPosition and an endPosition. Time values are always Universal Time in ISO 8601 format (yyyy-mm-ddThh:mm:ssZ). If the offering remains in operation, then the end time has not yet been defined so the value indeterminatePosition="now" is specified.<br>
_Example:_
{{{
<time>
  <gml:TimePeriod>
    <gml:beginPosition>2010-11-15T18:15:00Z</gml:beginPosition>
    <gml:endPosition indeterminatePosition="now"/>
  </gml:TimePeriod>
</time>
}}}
_Note:_ The overall start and end times do not indicate whether data gaps exist. If an offering comprises multiple sensors, each with different start or end times (for example, a new sensor was added at a later date), the start and end times indicate the overall period during which at least some data are available.

===Other Information===

====procedure====
_Role:_ The official IOOS identifier for the platform or network. The value of this identifier can be used in DescribeSensor requests for additional metadata and in GetObservation requests for actual data.
Content: A Uniform Resource Name (URN) that obeys the IOOS URN convention described at [Fill in URL].<br>
_Example:_ urn:ioos:station:wmo:21401.<br>
_Note:_ Previously, IOOS used multiple procedures per offering (one per sensor); SOS 2.0 allows only one procedure, which is now redundant with gml:name. There has been discussion of using gml:name for the station name information now found in gml:description.

====observedProperty (1 or more)====
_Role:_ A list of one or more quantities observed by this offering. The observedProperty identifier is used in GetObservation requests to obtain actual data.<br>
_Content:_ A URL from the Marine Metadata Interoperability (MMI) project corresponding to a Climate and Forecast (CF) Standard Name.<br>
_Example:_ http://mmisw.org/ont/cf/parameter/sea_floor_depth_below_sea_surface

=Other Issues=