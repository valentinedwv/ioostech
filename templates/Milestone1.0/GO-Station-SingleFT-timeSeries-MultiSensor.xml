<?xml version="1.0" encoding="UTF-8"?>
<!-- ==================================================
** COMMENTS on namespace specifications:
 - gml: using an unversioned namespace has been confirmed to be ok;
   the om 1.0 schema defines GML 3.1.1 as the version used
================================================== -->
<om:ObservationCollection 
  xmlns:om="http://www.opengis.net/om/1.0"
  xmlns:gml="http://www.opengis.net/gml" 
  xmlns:swe="http://www.opengis.net/swe/1.0.1"
  xmlns:xlink="http://www.w3.org/1999/xlink" 
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.opengis.net/om/1.0 
    http://schemas.opengis.net/om/1.0.0/observation.xsd">

  <!-- DISCLAIMER -->
  <gml:metaDataProperty xlink:title="disclaimer">
    <gml:GenericMetaData>
      <gml:description>DISCLAIMER</gml:description>
    </gml:GenericMetaData>
  </gml:metaDataProperty>
  <!-- ===========================================================
    - For a station offering, the response will return one CF feature type,
      corresponding to one om:member/om:Observation block.
    - For a network offering, the response may return multiple stations
      (features) spanning up to 3 CF feature types; each unique CF feature 
      type will be encoded in a separate om:member/om:Observation block 
      that may contain multiple stations.
    =========================================================== -->
  <om:member>
    <om:Observation>

      <!-- ==================================================================
        =====================================================================
        *******             START OF "METADATA" BLOCK                 *******
        =====================================================================
        ===================================================================== -->
      <!-- =========================================================== 
        description and name 
        COMMENTS:
        - We should come up with a guideline for the content of gml: description element
        - Is this gml:name convention a good way to go? It's what NDBC is currently doing.
        - What convention for procedure and name should be used when more than one 
          offering is requested?
        ============================================================== -->
      <gml:description>Observations at point station urn:ioos:station:wmo:41001, 
        150 NM East of Cape HATTERAS</gml:description>
      <gml:name>urn:ioos:station:wmo:41001</gml:name>

      <!-- ===========================================================
        samplingTime  
        Includes all temporal response metadata, encoded as an iso8601 string.
        Currently only UTC is supported/advocated.
        ============================================================== -->
      <om:samplingTime>
        <gml:TimePeriod>
          <gml:beginPosition>2009-05-23T00:00:00Z</gml:beginPosition>
          <gml:endPosition>2009-05-23T02:00:00Z</gml:endPosition>
        </gml:TimePeriod>
      </om:samplingTime>

      <!-- ===========================================================
        procedure
        Same as the offering request (station or network "asset type").
        COMMENTS/ISSUE: If more than one station offering is requested, in
        principle more than one procedure should be returned. But it 
        looks like it's illegal to have more than one procedure element! 
        =========================================================== -->
      <om:procedure xlink:href="urn:ioos:station:wmo:41001"/>
      
      <!-- ===========================================================
        observedProperty  
        This block contains a list of *scalar* properties only, referencing the 
        MMI CF or IOOS parameter vocabularies; see the wiki documentation on the 
        topic for the choice of vocabularies. Requests constructed using composite 
        (vector) phenomena such as "winds" will return the scalar components only. 
        This scheme accommodates both true composite phenomena like winds, and 
        ad-hoc requests for multiple properties (eg, water and air temperature). 
        The general swe:CompositePhenomenon element is used even when the response 
        returns a single observed property.
        ============================================================== -->
      <om:observedProperty>
        <swe:CompositePhenomenon dimension="5" gml:id="observedproperties1">
          <gml:name>Response Observed Properties</gml:name>
          <swe:component xlink:href="http://mmisw.org/ont/cf/parameter/air_temperature"/>
          <swe:component xlink:href="http://mmisw.org/ont/cf/parameter/wind_speed"/>
          <swe:component xlink:href="http://mmisw.org/ont/cf/parameter/wind_direction"/>
          <swe:component xlink:href="http://mmisw.org/ont/cf/parameter/sea_water_temperature"/>
          <swe:component xlink:href="http://mmisw.org/ont/ioos/parameter/dissolved_oxygen"/>
        </swe:CompositePhenomenon>
      </om:observedProperty>

      <!-- ===========================================================
        featureOfInterest  
        Encompasses *all* spatial and feature-type response metadata.
        ============================================================== -->
      <om:featureOfInterest>
        <gml:FeatureCollection>
          <!-- CF Feature Type (discrete-sampling-geometry) -->
          <gml:metaDataProperty>
            <gml:name codeSpace="http://cf-pcmdi.llnl.gov/documents/cf-conventions/1.6/cf-conventions.html#discrete-sampling-geometries">timeSeries</gml:name>
          </gml:metaDataProperty>

          <!-- Geographic (lat lon) Bounding Box -->
          <gml:boundedBy>
            <gml:Envelope srsName="http://www.opengis.net/def/crs/EPSG/0/4326">
              <gml:lowerCorner>34.7 -72.73</gml:lowerCorner>
              <gml:upperCorner>34.7 -72.73</gml:upperCorner>
            </gml:Envelope>
          </gml:boundedBy>

          <!-- Feature geographic (lat lon) location -->
          <!-- COMMENTS: 
          - gml:location is annotated as "Deprecated in GML 3.1.0". Still, we agreed
            is use is appropriate for now, and better than the alternatives.
          - I propose the use of gml:location/gml:MultiPoint/gml:pointMembers as a
            generalized way to also handle Network-offering responses that include
            multiple points (stations), as well as requests for multiple station offerings. 
            This is analogous to our use of 
            om:observedProperty/swe:CompositePhenomenon even for single-property responses.
          - Always use epsg 4326 -->
          <gml:location>
            <gml:MultiPoint srsName="http://www.opengis.net/def/crs/EPSG/0/4326">
              <gml:pointMembers>
                <gml:Point>
                  <gml:name>urn:ioos:station:wmo:41001</gml:name>
                  <gml:pos>34.7 -72.73</gml:pos>
                </gml:Point>
              </gml:pointMembers>
            </gml:MultiPoint>
          </gml:location>
        </gml:FeatureCollection>
      </om:featureOfInterest>
      <!-- ==================================================================
        =====================================================================
        *******              END OF "METADATA" BLOCK                  *******
        =====================================================================
        ===================================================================== -->


      <!-- ===========================================================
        om:result block
        COMMENTS: The om:result block below is not ready for comments yet, 
        and is currently not fully consistent with the "metadata" block above. 
        It will be soon.
        =========================================================== -->
      <om:result>
        <swe:DataStream>
          <!-- ===========================================================
               (Emilio, 5/18/12) sensor_id belongs under swe:item/swe:DataRecord below
               Maybe it should be optional, for cases where it's not meaningful?
               =========================================================== 
          COMMENTS: USE CONSISTENT NAMES FOR THE "stationID" LABEL! In the swe:field
          block below, both station_id and stationID are used. In the DescribeSensor
          sensorML, StationID and stationID. Stick to a single form, in uniform case. 
          -->
          <swe:field name="station_id">
            <swe:Text definition="urn:ioos:def:identifier:IOOS:stationID">
              <swe:value>urn:ioos:station:wmo:41001</swe:value>
            </swe:Text>
          </swe:field>
          <swe:Vector definition="http://www.opengis.net/def/property/OGC/0/PlatformLocation"
            referenceFrame="http://www.opengis.net/def/crs/EPSG/0/4326">
            <swe:coordinate name="lat">
              <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/latitude">
                <swe:uom code="deg"/>
                <swe:value>32.5</swe:value>
              </swe:Quantity>
            </swe:coordinate>
            <swe:coordinate name="lon">
              <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/longitude">
                <swe:uom code="deg"/>
                <swe:value>-78.5</swe:value>
              </swe:Quantity>
            </swe:coordinate>
          </swe:Vector>
          <swe:field name="time">
            <swe:Time definition="http://www.opengis.net/def/property/OGC/0/SamplingTime">
              <swe:uom xlink:href="http://www.opengis.net/def/uom/ISO-8601/0/Gregorian"/>
            </swe:Time>
          </swe:field>
          
          <swe:DataChoice>
            <!-- ===========================================================
              custom swe:item field definitions
              If available, can use a shorthand version for sensor brand and 
              description in swe:item name and gml:name
              =========================================================== -->
            <swe:item name="sensor1">
              <swe:DataRecord>
                <!-- COMMENT: Use IOOS sensor ID urn in gml:name ?
                     IS THERE STILL A NEED FOR A sensor_id swe:field element? -->
                <gml:name>sensor1</gml:name>
                <swe:field name="alt">
                  <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/altitude">
                    <swe:uom code="m"/>
                    <swe:value>5</swe:value>
                  </swe:Quantity>
                </swe:field>
                <swe:field name="temp">
                  <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/air_temperature">
                    <swe:uom code="Celsius"/>
                  </swe:Quantity>
                </swe:field>
                <swe:field name="windspeed">
                  <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/wind_speed">
                    <swe:uom code="m/s"/>
                  </swe:Quantity>
                </swe:field>
                <swe:field name="winddirection">
                  <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/wind_direction">
                    <swe:uom code="degrees(from)"/>
                  </swe:Quantity>
                </swe:field>
              </swe:DataRecord>
            </swe:item>
            <!-- ===========================================================
              swe:item field definitions
              =========================================================== -->
            <swe:item name="watersensors">
              <swe:DataRecord>
                <!-- COMMENT: Use IOOS sensor ID urn in gml:name ?
                     IS THERE STILL A NEED FOR A sensor_id FIELD? -->
                <gml:name>Water sensors</gml:name>
                <swe:field name="alt">
                  <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/altitude">
                    <swe:uom code="m"/>
                    <swe:value>-2</swe:value>
                  </swe:Quantity>
                </swe:field>
                <swe:field name="watertemp">
                  <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/sea_water_temperature">
                    <swe:uom code="Celsius"/>
                  </swe:Quantity>
                </swe:field>
                <swe:field name="dissolved_oxygen">
                  <swe:Quantity definition="http://mmisw.org/ont/ioos/parameter/dissolved_oxygen">
                    <swe:uom code="mg/L"/>
                  </swe:Quantity>
                </swe:field>
              </swe:DataRecord>
            </swe:item>
          </swe:DataChoice>

          <!-- ===========================================================
              SWE encoding and data values
              swe:encoding *must* be always specified exactly as described below,
              to avoid the need to have fully general parsers that interpret
              swe:TextEncoding. That is, parsers may hard-code this particular
              swe:TextEncoding specification.
              =========================================================== -->
          <swe:encoding>
            <swe:TextEncoding decimalSeparator="." tokenSeparator="," blockSeparator="\n"/>
          </swe:encoding>
          <swe:values> 
            2009-05-23T00:00:00Z,sensor1,15.4,2.0,280
            2009-05-23T01:00:00Z,sensor1,15.8,1.8,121
            2009-05-23T02:00:00Z,sensor1,15.6,1.0,1.42
            2009-05-23T00:00:00Z,watersensors,5.6,8.0
            2009-05-23T01:00:00Z,watersensors,5.8,8.2
            2009-05-23T02:00:00Z,watersensors,5.7,8.5
          </swe:values>
        </swe:DataStream>
      </om:result>

    </om:Observation>
  </om:member>
</om:ObservationCollection>
