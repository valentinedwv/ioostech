<?xml version="1.0" encoding="UTF-8"?>
<!-- ==================================================
** Compare this with ObservationSeries.xml from Mike Bott's SWE Common 2 examples
** namespace specifications:
 - gml: Why isn't it declared with a specific version?
   According to Oxygen validator, it should be 3.1.0, I think
 - swe: Ditto? I've changed it to 1.0.1 
 - xsi:schemaLocation: An example I've seen elsewhere uses:
     xsi:schemaLocation="http://www.opengis.net/swe/1.0.1
        htp://schemas.opengis.net/sweCommon/1.0.1/swe.xsd"
    Would that be relevant and/or legal here? Does it address the problem
    with SWE Common not seeming well annotated or "validatable"?
    ** Ask on ioostech_dev?!
================================================== -->
<om:ObservationCollection xmlns:om="http://www.opengis.net/om/1.0"
  xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1"
  xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.opengis.net/om/1.0 
    http://schemas.opengis.net/om/1.0.0/observation.xsd">

  <!-- ===========================================================
    - For a station offering, the response will return one CF feature type,
      corresponding to one om:member/om:Observation block.
    - For a network offering, the response may return multiple stations
      (features) spanning up to 3 CF feature types; each unique CF feature 
      type will be encoded in a separate om:member/om:Observation block 
      that may contain multiple stations.
    =========================================================== -->
  <om:member>
    <om:Observation>

      <!-- ==================================================================
        =====================================================================
        *******             START OF "METADATA" BLOCK                 *******
        =====================================================================
        ===================================================================== -->
      <gml:description>Observations at point station urn:ioos:station:wmo:41001, 150 NM East of Cape HATTERAS</gml:description>
      <!-- USE A DIFFERENT CONVENTION FOR gml:name? -->
      <gml:name>urn:ioos:station:wmo:41001</gml:name>

      <!-- ===========================================================
        samplingTime  
        Includes all temporal response metadata, encoded as an iso8601 string.
        Currently only UTC is supported/advocated.
        ============================================================== -->
      <om:samplingTime>
        <gml:TimePeriod>
          <gml:beginPosition>2009-05-23T00:00:00Z</gml:beginPosition>
          <gml:endPosition>2009-05-23T02:00:00Z</gml:endPosition>
        </gml:TimePeriod>
      </om:samplingTime>

      <!-- ===========================================================
        procedure
        Same as the offering request (station or network "asset type").
        =========================================================== -->
      <om:procedure xlink:href="urn:ioos:station:wmo:41001"/>

      <!-- ===========================================================
        observedProperty  
        This block contains a list of *scalar* properties only, referencing the 
        MMI CF or IOOS parameter vocabularies; see the wiki documentation on the 
        topic for the choice of vocabularies. Requests constructed using composite 
        (vector) phenomena such as "winds" will return the scalar components only. 
        This scheme accommodates both true composite phenomena like winds, and 
        ad-hoc requests for multiple properties (eg, water and air temperature). 
        The general swe:CompositePhenomenon element is used even when the response 
        returns a single observed property.
        ============================================================== -->
      <om:observedProperty>
        <swe:CompositePhenomenon dimension="3" gml:id="op_id_1">
          <gml:name>Response Observed Properties</gml:name>
          <swe:component xlink:href="http://mmisw.org/ont/cf/parameter/air_temperature"/>
          <swe:component xlink:href="http://mmisw.org/ont/cf/parameter/wind_speed"/>
          <swe:component xlink:href="http://mmisw.org/ont/cf/parameter/wind_direction"/>
          <swe:component xlink:href="http://mmisw.org/ont/cf/parameter/sea_water_temperature"/>
          <swe:component xlink:href="http://mmisw.org/ont/ioos/parameter/dissolved_oxygen"/>
        </swe:CompositePhenomenon>
      </om:observedProperty>

      <!-- ===========================================================
        featureOfInterest  
        Includes all spatial and feature-type response metadata.
        ============================================================== -->
      <om:featureOfInterest>
        <gml:FeatureCollection>
          <!-- CF Feature Type (discrete-sampling-geometry) -->
          <gml:metaDataProperty>
            <gml:name codeSpace="http://cf-pcmdi.llnl.gov/documents/cf-conventions/1.6/cf-conventions.html#discrete-sampling-geometries">timeSeries</gml:name>
          </gml:metaDataProperty>

          <!-- Geographic (lat lon) Bounding Box -->
          <!-- COMMENTS: Moved gml:boundedBy block to here (inside om:featureOfInterest 
          rather than outside), so that om:featureOfInterest contains all spatial and
          feature=type response metadata. Is this a problem? -->
          <gml:boundedBy>
            <gml:Envelope srsName="http://www.opengis.net/def/crs/EPSG/0/4326">
              <gml:lowerCorner>34.7 -72.73</gml:lowerCorner>
              <gml:upperCorner>34.7 -72.73</gml:upperCorner>
            </gml:Envelope>
          </gml:boundedBy>

          <!-- Feature geographic (lat lon) location -->
          <!-- COMMENTS: 
          - gml:location is annotated as "Deprecated in GML 3.1.0". Is this a problem?
            Use gml:featureMember instead?
          - The use of gml:location/gml:MultiPoint/gml:pointMembers is proposed as a
            generalized way to also handle Network-offering responses that include
            multiple points (stations). This is analogous to our use of 
            om:observedProperty/swe:CompositePhenomenon even for single-property responses.
          - Always use epsg 4326 -->
          <gml:location>
            <gml:MultiPoint srsName="http://www.opengis.net/def/crs/EPSG/0/4326">
              <gml:pointMembers>
                <gml:Point>
                  <gml:pos>34.7 -72.73</gml:pos>
                </gml:Point>
              </gml:pointMembers>
            </gml:MultiPoint>
          </gml:location>
        </gml:FeatureCollection>
      </om:featureOfInterest>
      <!-- ==================================================================
        =====================================================================
        *******              END OF "METADATA" BLOCK                  *******
        =====================================================================
        ===================================================================== -->


      <!-- ===========================================================
           om:result block
           =========================================================== -->
      <om:result>
        <swe:DataStream>
          <!-- ===========================================================
               (Emilio, 5/18/12) sensor_id belongs under swe:item/swe:DataRecord below
               Maybe it should be optional, for cases where it's not meaningful?
               (Emilio, 6/5/12) assigned the swe:Category definition to the urn
               used in SensorML <sml:identifier name="StationID"><sml:Term definition="">
               =========================================================== -->
          <swe:field name="station_id">
            <swe:Category definition="urn:ioos:def:identifier:NOAA:stationID">
              <swe:value>urn:ioos:station:wmo:41001</swe:value>
            </swe:Category>
          </swe:field>
          <swe:Vector definition="http://www.opengis.net/def/property/OGC/0/PlatformLocation"
            referenceFrame="http://www.opengis.net/def/crs/EPSG/0/4326">
            <swe:coordinate name="lat">
              <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/latitude">
                <swe:uom code="deg"/>
                <swe:value>32.5</swe:value>
              </swe:Quantity>
            </swe:coordinate>
            <swe:coordinate name="lon">
              <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/longitude">
                <swe:uom code="deg"/>
                <swe:value>-78.5</swe:value>
              </swe:Quantity>
            </swe:coordinate>
          </swe:Vector>
          <swe:field name="time">
            <swe:Time definition="http://www.opengis.net/def/property/OGC/0/SamplingTime">
              <swe:uom xlink:href="http://www.opengis.net/def/uom/ISO-8601/0/Gregorian"/>
            </swe:Time>
          </swe:field>
          <swe:DataChoice>
            <swe:item name="SENSOR_1">
              <swe:DataRecord>
                <gml:name>First Sensor (SENSOR_1)</gml:name>
                <!-- ===========================================================
                     (Emilio, 5/18/12) For single-station responses, it seems redundant,
                     verbose and unnecessary to have a Vector location swe:field in
                     addition to <om:featureOfInterest> already listed above
                     =========================================================== -->
                <swe:field name="alt">
                  <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/altitude">
                    <swe:uom code="m"/>
                    <swe:value>10</swe:value>
                  </swe:Quantity>
                </swe:field>
                <swe:field name="temp">
                  <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/air_temperature">
                    <swe:uom code="Cel"/>
                  </swe:Quantity>
                </swe:field>
              </swe:DataRecord>
            </swe:item>
            <swe:item name="SENSOR_2">
              <swe:DataRecord>
                <gml:name>Second Sensor (SENSOR_2)</gml:name>
                <swe:field name="location">
                  <swe:Vector
                    definition="http://www.opengis.net/def/property/OGC/0/PlatformLocation"
                    referenceFrame="http://www.opengis.net/def/crs/EPSG/0/4979">
                    <swe:coordinate name="lat">
                      <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/latitude"
                        axisID="Lat">
                        <swe:uom code="deg"/>
                        <swe:value>32.5</swe:value>
                      </swe:Quantity>
                    </swe:coordinate>
                    <swe:coordinate name="lon">
                      <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/longitude"
                        axisID="Long">
                        <swe:uom code="deg"/>
                        <swe:value>-78.5</swe:value>
                      </swe:Quantity>
                    </swe:coordinate>
                    <swe:coordinate name="alt">
                      <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/altitude"
                        axisID="h">
                        <swe:uom code="m"/>
                        <swe:value>-4</swe:value>
                      </swe:Quantity>
                    </swe:coordinate>
                  </swe:Vector>
                </swe:field>
                <swe:field name="chlorophyll">
                  <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/chlorophyll">
                    <swe:uom code="Cel"/>
                  </swe:Quantity>
                </swe:field>
                <swe:field name="dissolved_oxygen">
                  <swe:Quantity definition="http://mmisw.org/ont/ioos/parameter/dissolved_oxygen">
                    <swe:uom code="hPa"/>
                  </swe:Quantity>
                </swe:field>
              </swe:DataRecord>
            </swe:item>
          </swe:DataChoice>
          <swe:encoding>
            <swe:TextEncoding blockSeparator="\n" tokenSeparator=","/>
          </swe:encoding>
          <swe:values> 2009-05-23T00:00:00Z,SENSOR_1,15.4 2009-05-23T01:00:00Z,SENSOR_1,15.8
            2009-05-23T02:00:00Z,SENSOR_1,15.6 2009-05-23T00:00:00Z,SENSOR_2,300,56.7
            2009-05-23T01:00:00Z,SENSOR_2,310,52.6 2009-05-23T02:00:00Z,SENSOR_2,320,62.5
          </swe:values>
        </swe:DataStream>
      </om:result>

    </om:Observation>
  </om:member>
</om:ObservationCollection>
