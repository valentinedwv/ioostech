<?xml version="1.0" encoding="UTF-8"?>
<!-- ==================================================
** COMMENTS on namespace specifications:
 - gml: using an unversioned namespace has been confirmed to be ok;
   the om 1.0 schema defines GML 3.1.1 as the version used
================================================== -->
<om:ObservationCollection 
  xmlns:om="http://www.opengis.net/om/1.0"
  xmlns:gml="http://www.opengis.net/gml" 
  xmlns:swe="http://www.opengis.net/swe/1.0.1"
  xmlns:xlink="http://www.w3.org/1999/xlink" 
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.opengis.net/om/1.0 
    http://schemas.opengis.net/om/1.0.0/observation.xsd">

  <!-- ==================================================================
       TOP-LEVEL METADATA
       =============================================================== -->
  <!-- DISCLAIMER -->
  <gml:metaDataProperty xlink:title="disclaimer">
    <gml:GenericMetaData>
      <gml:description>DISCLAIMER</gml:description>
    </gml:GenericMetaData>
  </gml:metaDataProperty>
  
  <!-- OFFERING URN REQUESTED. Holds asset id urn -->
  <gml:name>urn:ioos:station:wmo:41001</gml:name>
  <!-- ================================================================== -->
  
  <!-- ===========================================================
    - For a station offering, the response will return one CF feature type,
      corresponding to one om:member/om:Observation block.
    - For a network offering, the response may return multiple stations
      (features) spanning up to 3 CF feature types; each unique CF feature 
      type will be encoded in a separate om:member/om:Observation block 
      that may contain multiple stations.
    =========================================================== -->
  <om:member>
    <om:Observation>

      <!-- ==================================================================
        =====================================================================
        *******             START OF "METADATA" BLOCK                 *******
        =====================================================================
        ===================================================================== -->
      
      <!-- =========================================================== 
        gml:name Naming pattern:  <OFFERING ASSET URN>-<FEATURE TYPE>
        gml:description: COME UP WITH USAGE GUIDELINE FOR THIS ELEMENT'S CONTENT
        ============================================================== -->
      <gml:description>Observations at point station urn:ioos:station:wmo:41001, 
        150 NM East of Cape HATTERAS</gml:description>
      <gml:name>urn:ioos:station:wmo:41001-timeSeries</gml:name>

      <!-- ===========================================================
        samplingTime  
        Includes all temporal response metadata, encoded as an iso8601 string.
        Currently only UTC is supported/advocated.
        ============================================================== -->
      <om:samplingTime>
        <gml:TimePeriod>
          <gml:beginPosition>2009-05-23T00:00:00Z</gml:beginPosition>
          <gml:endPosition>2009-05-23T02:00:00Z</gml:endPosition>
        </gml:TimePeriod>
      </om:samplingTime>

      <!-- ===========================================================
        procedure
        =========================================================== -->
      <!-- additional stations returned by a network offering will be listed
        as additional gml:member elements -->
      <om:procedure>
        <om:Process>
          <gml:member xlink:href="urn:ioos:station:wmo:41001"/>
        </om:Process>
      </om:procedure>
      
      <!-- ===========================================================
        observedProperty  
        This block contains a list of *scalar* properties only, referencing the 
        MMI CF or IOOS parameter vocabularies; see the wiki documentation on the 
        topic for the choice of vocabularies. Requests constructed using composite 
        (vector) phenomena such as "winds" will return the scalar components only. 
        This scheme accommodates both true composite phenomena like winds, and 
        ad-hoc requests for multiple properties (eg, water and air temperature). 
        The general swe:CompositePhenomenon element is used even when the response 
        returns a single observed property.
        ============================================================== -->
      <om:observedProperty>
        <swe:CompositePhenomenon dimension="5" gml:id="observedproperties1">
          <gml:name>Response Observed Properties</gml:name>
          <swe:component xlink:href="http://mmisw.org/ont/cf/parameter/air_temperature"/>
          <swe:component xlink:href="http://mmisw.org/ont/cf/parameter/wind_speed"/>
          <swe:component xlink:href="http://mmisw.org/ont/cf/parameter/wind_direction"/>
          <swe:component xlink:href="http://mmisw.org/ont/cf/parameter/sea_water_temperature"/>
          <swe:component xlink:href="http://mmisw.org/ont/ioos/parameter/dissolved_oxygen"/>
        </swe:CompositePhenomenon>
      </om:observedProperty>

      <!-- ===========================================================
        featureOfInterest  
        Encompasses *all* spatial and feature-type response metadata.
        ============================================================== -->
      <om:featureOfInterest>
        <gml:FeatureCollection>
          <!-- CF Feature Type (discrete-sampling-geometry) -->
          <gml:metaDataProperty>
            <gml:name codeSpace="http://cf-pcmdi.llnl.gov/documents/cf-conventions/1.6/cf-conventions.html#discrete-sampling-geometries">timeSeries</gml:name>
          </gml:metaDataProperty>

          <!-- Geographic (lat lon) Bounding Box -->
          <gml:boundedBy>
            <gml:Envelope srsName="http://www.opengis.net/def/crs/EPSG/0/4326">
              <gml:lowerCorner>34.7 -72.73</gml:lowerCorner>
              <gml:upperCorner>34.7 -72.73</gml:upperCorner>
            </gml:Envelope>
          </gml:boundedBy>

          <!-- Feature geographic location (lat & lon only, no z) -->
          <!-- Always use epsg 4326.
            Use gml:location/gml:MultiPoint/gml:pointMembers as a generalized way to
            also handle Network-offering responses that include multiple points (stations). 
            This is analogous to our use of om:observedProperty/swe:CompositePhenomenon 
            even for single-property responses. -->
          <gml:location>
            <gml:MultiPoint srsName="http://www.opengis.net/def/crs/EPSG/0/4326">
              <gml:pointMembers>
                <gml:Point>
                  <gml:name>urn:ioos:station:wmo:41001</gml:name>
                  <gml:pos>34.7 -72.73</gml:pos>
                </gml:Point>
              </gml:pointMembers>
            </gml:MultiPoint>
          </gml:location>
        </gml:FeatureCollection>
      </om:featureOfInterest>
      <!-- ==================================================================
        =====================================================================
        *******              END OF "METADATA" BLOCK                  *******
        =====================================================================
        ===================================================================== -->


      <!-- ===========================================================
        om:result (THE "DATA" BLOCK)
        =========================================================== -->
      <om:result>
        <swe:DataStream>
          <!-- ==================== PLATFORM-WIDE FIELDS ======================= -->
          <!-- stationID 
          For consistency, "stationID" should always be spelled out this way, 
          (and never as, say, "station_id") using the same case, for readability. -->
          <swe:field name="stationID">
            <swe:Text definition="urn:ioos:def:identifier:IOOS:stationID">
              <swe:value>urn:ioos:station:wmo:41001</swe:value>
            </swe:Text>
          </swe:field>
          <!-- latitude and longitude, always in epsgs 4326 -->
          <swe:Vector definition="http://www.opengis.net/def/property/OGC/0/PlatformLocation"
            referenceFrame="http://www.opengis.net/def/crs/EPSG/0/4326">
            <!--  COMMENT: Removed axisID attributes on swe:Quantity; not strictly needed? -->
            <swe:coordinate name="lat">
              <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/latitude">
                <swe:uom code="deg"/>
                <swe:value>32.5</swe:value>
              </swe:Quantity>
            </swe:coordinate>
            <swe:coordinate name="lon">
              <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/longitude">
                <swe:uom code="deg"/>
                <swe:value>-78.5</swe:value>
              </swe:Quantity>
            </swe:coordinate>
          </swe:Vector>
          <!-- date-time 
            COMMENT: double-check that these time definition and swe:uom xlink:href are good choices -->
          <swe:field name="time">
            <swe:Time definition="http://www.opengis.net/def/property/OGC/0/SamplingTime">
              <swe:uom xlink:href="http://www.opengis.net/def/uom/ISO-8601/0/Gregorian"/>
            </swe:Time>
          </swe:field>
          
          <!-- ==================== SENSOR-SPECIFIC FIELDS ======================= -->
          <swe:DataChoice>
            <!-- ===========================================================
              custom swe:item field definitions
              =========================================================== -->

            <!-- ===========================================================
              sensor id urn
              COMMENTS: 
              - A swe:field for sensor id doesn't seem to be strictly needed
              or particularly useful. We're already breaking up data fields by "sensor"
              using sensor-specific swe:item blocks.
              - swe:DataRecord/gml:name seems adequate for storing a sensor id urn.
              The sensor id urn may use a meaningful component value (eg, "sbe16") or,
              if not available, a simple, unique value such as "sensor1" vs "sensor2".
              - swe:item name attribute should be globally unique within this response,
              at the very least within each om:member/om:Observation block. Using a simple
              constant string followed by an integer counter (sensor1, sensor2, etc)
              may be enough.
              - Is it a rule that the swe:item name attribute will be used as a field value 
              in swe:values, as shown on the original template? Or is a sensor id swe:field  
              required to accomplish this??
              =========================================================== -->
            <swe:item name="sensor1">
              <swe:DataRecord>
                <gml:name>urn:ioos:sensor:wmo:41001:sensor1</gml:name>
                <swe:field name="alt">
                  <!-- COMMENT: Looks like the alt swe:Quantity can have a referenceFrame attribute:
                    <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/altitude" 
                    referenceFrame="http://www.opengis.net/def/crs/EPSG/0/4326">
                    This attribute could point to a vertical datum. Look into Oostethys discussions
                    on vertical datums, and Issue 16 -->
                  <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/altitude" referenceFrame="http://www.opengis.net/def/crs/EPSG/0/4326">
                    <swe:uom code="m"/>
                    <swe:value>5</swe:value>
                  </swe:Quantity>
                </swe:field>
                <swe:field name="temp">
                  <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/air_temperature">
                    <swe:uom code="Celsius"/>
                  </swe:Quantity>
                </swe:field>
                <swe:field name="windspeed">
                  <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/wind_speed">
                    <swe:uom code="m/s"/>
                  </swe:Quantity>
                </swe:field>
                <swe:field name="winddirection">
                  <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/wind_to_direction">
                    <swe:uom code="degrees"/>
                  </swe:Quantity>
                </swe:field>
              </swe:DataRecord>
            </swe:item>
            <!-- ===========================================================
              custom swe:item field definitions
              =========================================================== -->
            <swe:item name="sensor2">
              <swe:DataRecord>
                <gml:name>urn:ioos:sensor:wmo:41001:sbe28</gml:name>
                <swe:field name="alt">
                  <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/altitude">
                    <swe:uom code="m"/>
                    <swe:value>-2</swe:value>
                  </swe:Quantity>
                </swe:field>
                <swe:field name="watertemp">
                  <swe:Quantity definition="http://mmisw.org/ont/cf/parameter/sea_water_temperature">
                    <swe:uom code="Celsius"/>
                  </swe:Quantity>
                </swe:field>
                <swe:field name="dissolved_oxygen">
                  <swe:Quantity definition="http://mmisw.org/ont/ioos/parameter/dissolved_oxygen">
                    <swe:uom code="mg/L"/>
                  </swe:Quantity>
                </swe:field>
              </swe:DataRecord>
            </swe:item>
          </swe:DataChoice>

          <!-- ===========================================================
              SWE encoding and data values
              swe:encoding *must* be always specified exactly as described below,
              to avoid the need to have fully general parsers that interpret
              swe:TextEncoding. That is, parsers may hard-code this particular
              swe:TextEncoding specification.
              =========================================================== -->
          <swe:encoding>
            <swe:TextEncoding decimalSeparator="." tokenSeparator="," blockSeparator="\n"/>
          </swe:encoding>
          <swe:values> 
            2009-05-23T00:00:00Z,sensor1,15.4,2.0,280
            2009-05-23T01:00:00Z,sensor1,15.8,1.8,121
            2009-05-23T02:00:00Z,sensor1,15.6,1.0,1.42
            2009-05-23T00:00:00Z,sensor2,5.6,8.0
            2009-05-23T01:00:00Z,sensor2,5.8,8.2
            2009-05-23T02:00:00Z,sensor2,5.7,8.5
          </swe:values>
        </swe:DataStream>
      </om:result>

    </om:Observation>
  </om:member>
</om:ObservationCollection>
